- ansible.builtin.import_tasks: create_user.yaml
  name: Create User Account
  register: user_created
- ansible.builtin.import_tasks: reflector.yaml
  name: Install and run reflector to update mirrors
  register: reflector_enabled
- ansible.builtin.import_tasks: minimal_packages.yaml
  name: Install minimal required packages
  register: minimal_packages_deployed
  when: pacman_ready
- ansible.builtin.import_tasks: microcodes.yaml
  name: Install architecture microcodes
  when: pacman_ready
- ansible.builtin.import_tasks: cockpit.yaml
  name: Install Cockpit web-based management
  when: minimal_packages_deployed
- ansible.builtin.import_tasks: locale.yaml
  name: Configure OS locale
- ansible.builtin.import_tasks: makepkg.yaml
  name: Deploy makepkg dropins
- ansible.builtin.import_tasks: pacman.yaml
  name: Configure pacman
  register: pacman_ready
- ansible.builtin.import_tasks: ntp.yaml
  name: Configure ntp
  when: (minimal_packages_deployed AND services_started)
- ansible.builtin.import_tasks: userconf_dropin.yaml
  name: Deploy userconf dropin files
- ansible.builtin.import_tasks: services.yaml
  name: Enable and start services
  when: minimal_packages_deployed
  register: services_started
